<%@page contentType="text/html" pageEncoding="UTF-8" %><%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %><%@ taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %><div class="tableBox">	<div class="messageContentDiv" id="messageContentDiv">		<c:forEach items="${messageContentList }" var="mc">			<c:choose>				<c:when test="${user.account != mc.sender }">					<p class="textLeft">						<span class="msgUserName">${message.sendType == 0 ? '系统' : mc.sender }</span>						<!--<span>：</span>-->						<span class="messageInfo messageLeft">							<c:out value="${mc.content }"></c:out>						</span>					</p>				</c:when>				<c:otherwise>					<p class="textRight">						<span class="messageInfo messageRight">							<c:out value="${mc.content }"></c:out>						</span>						<!--<span>：</span>-->						<span class="msgUserName">我</span>					</p>				</c:otherwise>			</c:choose>		</c:forEach>	</div>	<!-- 填写发送消息-->	<div class="msgSendContentDiv">		<label>			<textarea class="msgSendContent replyMsgContent" rows="3" id="msgSendContent"></textarea>		</label>		<!-- 弹窗按钮 -->		<a href="javascript:;" class="btn showMessageReply" id="showMessageReply"		   onclick="messageReply(${message.id });">回复</a>	</div></div><c:if test="${message.sendStatus == 5 || message.revStatus == 1 }">	<script type="text/javascript">		$("#messageRevStatus_${message.id }").text("已读").parent().removeClass('fontBold');	</script></c:if><script type="text/javascript">	if (contentTimer) {		clearInterval(contentTimer);	}	var doing = false;	var startTime = '${startTime }';	var contentTimer = setInterval(function () {		if (doing) {			return false;		}		doing = true;		// 如果已经关闭对话框则清除定时		if (!$("#mask").is(":visible")) {			clearInterval(contentTimer);			return false;		}		ajaxExt({			url: '/message/findMessageContent?messageId=${message.id }&startTime=' + startTime,			dataType: 'json',			loading: '',			noError: true,			callback: function (data) {				done(data);			},			complete: function () {			}		});	}, 10000);	function done(data) {		var list = data.messageContentList;		startTime = data.startTime;		var html = "";		for (var i = 0; i < list.length; i++) {			var mc = list[i];			html += '<p class="textLeft"><span class="msgUserName">' + mc.sender + '</span><span class="messageInfo messageLeft">' + mc.content + '</span><p>';		}		$("#messageContentDiv").append(html);		doing = false;		$('#messageContentDiv').scrollTop($('#messageContentDiv')[0].scrollHeight);	}</script>